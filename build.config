# ADB 编译配置文件
# 修改此文件来自定义编译行为

# ============= AOSP 配置 =============

# Android 版本
ANDROID_VERSION="13"
ANDROID_API_LEVEL="30"

# 编译目标
# 可选值: aosp_arm64, aosp_arm, aosp_x86_64, aosp_x86
BUILD_TARGET="aosp_arm64"

# 编译类型
# user     - 生产版本
# userdebug - 带调试符号
# eng      - 工程版本（推荐）
BUILD_TYPE="eng"

# ============= 编译器配置 =============

# 并行编译线程数
# 默认自动检测 nproc
# 可手动指定: 4, 8, 16 等
BUILD_JOBS=""

# 编译标志
CFLAGS="-O2 -Wall"
CXXFLAGS="-O2 -Wall -std=c++17"

# 启用 ccache（加速增量编译）
USE_CCACHE="true"

# ============= 优化选项 =============

# 启用 LTO（Link Time Optimization）
ENABLE_LTO="false"

# 启用 ThinLTO
ENABLE_THIN_LTO="false"

# 符号裁剪
STRIP_SYMBOLS="true"

# ============= 输出配置 =============

# 输出目录
OUTPUT_DIR="./output"

# 二进制文件名
OUTPUT_NAME="adbd_arm64"

# ============= GitHub Actions 配置 =============

# 是否上传到 Release
UPLOAD_RELEASE="true"

# 是否创建预发布版本
PRERELEASE="false"

# Release 描述文件
RELEASE_NOTES_FILE="RELEASE_NOTES.md"

# ============= Docker 配置（仅 Docker 编译） =============

# Docker 镜像
DOCKER_IMAGE="ubuntu:22.04"

# Docker 内存限制
DOCKER_MEMORY="16g"

# Docker CPU 限制
DOCKER_CPUS="4"

# ============= 本地 AOSP 路径（仅本地编译） =============

# AOSP 安装路径
AOSP_PATH="${HOME}/aosp"

# 编译输出路径
OUT_PATH="out/target/product/generic_arm64"

# ============= 调试选项 =============

# 保存编译日志
SAVE_BUILD_LOG="true"

# 日志文件路径
BUILD_LOG_FILE="./build.log"

# 详细输出
VERBOSE="false"

# ============= 超时配置 =============

# repo sync 超时（秒）
SYNC_TIMEOUT="3600"

# 编译超时（秒）
BUILD_TIMEOUT="7200"

# 重试次数
MAX_RETRIES="3"

# ============= 网络配置 =============

# repo 并行连接数
REPO_JOBS="4"

# HTTP 缓冲区大小（字节）
HTTP_BUFFER="524288000"

# 低速限制（字节/秒）
HTTP_LOW_SPEED="0"

# 低速时间限制（秒）
HTTP_LOW_SPEED_TIME="999999"

# ============= 清理选项 =============

# 编译前清理旧文件
CLEAN_BEFORE_BUILD="false"

# 编译后清理临时文件
CLEAN_AFTER_BUILD="true"

# 删除旧的二进制文件
DELETE_OLD_BINARY="true"

# ============= 钩子脚本 =============

# 编译前执行
PRE_BUILD_HOOK=""

# 编译后执行
POST_BUILD_HOOK=""

# 编译失败时执行
ON_BUILD_FAILURE=""

# ============= 通知配置 =============

# 编译完成时发送通知
NOTIFY_ON_COMPLETE="false"

# 编译失败时发送通知
NOTIFY_ON_FAILURE="true"

# 通知方式: email, webhook, slack
NOTIFICATION_TYPE="email"

# 通知地址
NOTIFICATION_ADDRESS=""

# ============= 高级选项 =============

# 启用 reproducible build
REPRODUCIBLE_BUILD="true"

# 启用 hardening
ENABLE_HARDENING="true"

# PIE（Position Independent Executable）
ENABLE_PIE="true"

# 栈保护
ENABLE_STACK_PROTECTOR="true"

# 完整性检查
ENABLE_CFI="true"

# ============= 版本控制 =============

# 版本号格式
# 可用变量: $DATE, $TIME, $COMMIT, $BUILD_NUMBER
VERSION_FORMAT="v\${BUILD_NUMBER}"

# 自动增加版本号
AUTO_INCREMENT_VERSION="true"

# 版本号文件
VERSION_FILE="version.txt"
